---
# https://wiki.codeblocks.org/index.php/Installing_Code::Blocks_from_source_on_RPM_based_distributions

- name: passwordless in Toolbox
  block:
  - name: Install build tools # https://github.com/ansible/ansible/issues/13222
    yum:
      name: "@Development tools"
      state: present
    become: yes

  - name: Install Build Dependencies
    become: true
    ansible.builtin.dnf:
      name:
      # Delete uneeded
        # - unzip
        # - make
        # - gettext
        # - autoconf
        # - automake
        # - libtool
        # - m4
        # - intltool
        # - gcc-c++
        # - libstdc++
        # - libstdc++-devel
      # Required
        - rpm-build
        - subversion
        - wxGTK-devel
      # configure --with-contrib-plugins=all
        - hunspell
        - hunspell-devel
      state: latest
  become_method: "su"  # Passwordless become in Toolbox
  when: ansible_nodename == "toolbox"

- name: dependency RPM Sphere
  ansible.builtin.include_role:
    name: RPM Sphere

- meta: end_play

- name: gamin-devel from RPM Sphere
  include_tasks: '{{ ansible_os_family }}/RPM Sphere/main.yml'

- name: Non-root rpmbuild environment
  ansible.builtin.script: rpmbuild_env.sh
  args:
    creates: "{{ ansible_env.HOME }}/.rpmmacros"